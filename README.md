# Generate IKFast Solver

This repository extracts only the IKSolver cpp file generation scripts from the [MoveIt ikfast_kinematics_plugin](https://github.com/moveit/moveit/tree/master/moveit_kinematics/ikfast_kinematics_plugin) repository.

The following command generates an IK solver cpp file from a sample URDF. Please replace the arguments and URDF as appropriate for your use.

```bash
scripts/auto_create_ikfast_moveit_plugin.sh --iktype Transform6D --freejoint joint_e1 --name m710ic70_7axis m710ic70_7axis.urdf base_link tool0
```

The following messages should be output to the console after script execution.

```bash
...(ommit)
Running scripts/create_ikfast_moveit_plugin.py "m710ic70_7axis" "m710ic70_7axis_generated" "base_link" "tool0" "/tmp/ikfast.Eb4zFA/.openrave/kinematics.9bd522f5363f03acb5ac636703d18794/ikfast0x10000049.Transform6D.1_2_3_4_5_6_f0.cpp"
Creating IKFastKinematicsPlugin with parameters: 
 robot_name:           m710ic70_7axis
 base_link_name:       base_link
 eef_link_name:        tool0
 ikfast_plugin_pkg:    m710ic70_7axis_generated
 ikfast_output_path:   /tmp/ikfast.Eb4zFA/.openrave/kinematics.9bd522f5363f03acb5ac636703d18794/ikfast0x10000049.Transform6D.1_2_3_4_5_6_f0.cpp
 eef_direction:        0 0 1

Found source code generated by IKFast version 73
Createing new package m710ic70_7axis_generated it in /home/dev/generate-ikfast-solver/m710ic70_7axis_generated.
Created ikfast header file at '/home/dev/generate-ikfast-solver/m710ic70_7axis_generated/include/ikfast.h'
Created ikfast c interface file at '/home/dev/generate-ikfast-solver/m710ic70_7axis_generated/src/ikfast_c_interface.cpp'
```

`m710ic70_7axis_ikfast_solver.cpp` is the IK solver generated from the URDF. All other files are copied from the templates directory.

```bash
m710ic70_7axis_generated/
├── include
│   └── ikfast.h
└── src
    ├── ikfast_c_interface.cpp
    └── m710ic70_7axis_ikfast_solver.cpp
```

## Options

* iktype: The IK type to build the solver (e.g., Transform6D, Rotation3D, Translation3D, etc.)
* freejoint: Optional joint name specifying a free parameter of the manipulator
* name: Specify the name attribute value of the robot element in the URDF

## Required Arguments

* 1st argument: URDF filename
    * (ex) m710ic70_7axis.urdf
* 2nd argument: BASE_LINK
    * (ex) base_link
* 3rd argument: EEF_LINK
    * (ex) flange

## References

* [OpenRAVE Inverse Kinematics Documentation](https://www.openrave.org/docs/latest_stable/openravepy/databases.inversekinematics/) - Detailed information about iktype and freejoint options
* [Introduction to IKFast and prerequisite](https://choreo.readthedocs.io/en/latest/doc/ikfast_tutorial.html)
* [Which joints to discretize for IK](https://robotics.stackexchange.com/questions/7786/which-joints-to-discretize-for-ik)
